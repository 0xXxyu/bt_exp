<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="531px" preserveAspectRatio="none" style="width:475px;height:531px;" version="1.1" viewBox="0 0 475 531" width="475px" zoomAndPan="magnify"><defs><filter height="300%" id="fd61dpuvf2moq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="243" x="115" y="26.708">Mandatory Authentication</text><ellipse cx="229.75" cy="40.9531" fill="#000000" filter="url(#fd61dpuvf2moq)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="385" x="37.25" y="70.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="361" x="51.25" y="92.0918">App calls gatt_client_set_required_security_level (level &gt; 0)</text><rect fill="#FEFECE" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="170.25" y="124.9219"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="184.25" y="146.0605">A connects to B</text><rect fill="#FEFECE" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="102.75" y="178.8906"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="230" x="116.75" y="200.0293">App triggers GATT Client request on A</text><polygon fill="#FEFECE" filter="url(#fd61dpuvf2moq)" points="191.75,232.8594,267.75,232.8594,279.75,244.8594,267.75,256.8594,191.75,256.8594,179.75,244.8594,191.75,232.8594" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="191.75" y="248.6675">LTK available</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="158.75" y="242.2651">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="279.75" y="242.2651">no</text><rect fill="#FEFECE" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="106.5" y="266.8594"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="120.5" y="287.998">start encryption</text><rect fill="#FEFECE" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="245.5" y="266.8594"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="259.5" y="287.998">start pairing</text><polygon fill="#FEFECE" filter="url(#fd61dpuvf2moq)" points="229.75,306.8281,241.75,318.8281,229.75,330.8281,217.75,318.8281,229.75,306.8281" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fd61dpuvf2moq)" points="172.75,350.8281,286.75,350.8281,298.75,362.8281,286.75,374.8281,172.75,374.8281,160.75,362.8281,172.75,350.8281" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="172.75" y="366.6362">paired/re-encrypted</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="139.75" y="360.2339">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="298.75" y="360.2339">no</text><rect fill="#FEFECE" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="26.5" y="384.8281"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149" x="40.5" y="405.9668">GATT Client request sent</text><rect fill="#23DB2B" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="11" y="438.7969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180" x="25" y="459.9355">App receives GATT Response</text><ellipse cx="113" cy="503.7656" fill="#FFFFFF" filter="url(#fd61dpuvf2moq)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="113" cy="503.7656" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FD5B41" filter="url(#fd61dpuvf2moq)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="235" y="384.8281"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="199" x="249" y="405.9668">App receives a GATT Client error</text><ellipse cx="346.5" cy="449.7969" fill="#FFFFFF" filter="url(#fd61dpuvf2moq)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="346.5" cy="449.7969" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="50.9531" y2="70.9531"/><polygon fill="#A80036" points="225.75,60.9531,229.75,70.9531,233.75,60.9531,229.75,64.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="104.9219" y2="124.9219"/><polygon fill="#A80036" points="225.75,114.9219,229.75,124.9219,233.75,114.9219,229.75,118.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="158.8906" y2="178.8906"/><polygon fill="#A80036" points="225.75,168.8906,229.75,178.8906,233.75,168.8906,229.75,172.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="179.75" x2="166" y1="244.8594" y2="244.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="166" x2="166" y1="244.8594" y2="266.8594"/><polygon fill="#A80036" points="162,256.8594,166,266.8594,170,256.8594,166,260.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="279.75" x2="293.5" y1="244.8594" y2="244.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="293.5" x2="293.5" y1="244.8594" y2="266.8594"/><polygon fill="#A80036" points="289.5,256.8594,293.5,266.8594,297.5,256.8594,293.5,260.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="166" x2="166" y1="300.8281" y2="318.8281"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="166" x2="217.75" y1="318.8281" y2="318.8281"/><polygon fill="#A80036" points="207.75,314.8281,217.75,318.8281,207.75,322.8281,211.75,318.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="293.5" x2="293.5" y1="300.8281" y2="318.8281"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="293.5" x2="241.75" y1="318.8281" y2="318.8281"/><polygon fill="#A80036" points="251.75,314.8281,241.75,318.8281,251.75,322.8281,247.75,318.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="212.8594" y2="232.8594"/><polygon fill="#A80036" points="225.75,222.8594,229.75,232.8594,233.75,222.8594,229.75,226.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="418.7969" y2="438.7969"/><polygon fill="#A80036" points="109,428.7969,113,438.7969,117,428.7969,113,432.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="472.7656" y2="492.7656"/><polygon fill="#A80036" points="109,482.7656,113,492.7656,117,482.7656,113,486.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="346.5" x2="346.5" y1="418.7969" y2="438.7969"/><polygon fill="#A80036" points="342.5,428.7969,346.5,438.7969,350.5,428.7969,346.5,432.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="160.75" x2="113" y1="362.8281" y2="362.8281"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="362.8281" y2="384.8281"/><polygon fill="#A80036" points="109,374.8281,113,384.8281,117,374.8281,113,378.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="298.75" x2="346.5" y1="362.8281" y2="362.8281"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="346.5" x2="346.5" y1="362.8281" y2="384.8281"/><polygon fill="#A80036" points="342.5,374.8281,346.5,384.8281,350.5,374.8281,346.5,378.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="330.8281" y2="350.8281"/><polygon fill="#A80036" points="225.75,340.8281,229.75,350.8281,233.75,340.8281,229.75,344.8281" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[d6a88a69f6170132d7249da8668bdf5d]
@startuml
title Mandatory Authentication
start
: App calls gatt_client_set_required_security_level (level > 0);
: A connects to B;
: App triggers GATT Client request on A;

if (LTK available) then (yes)
   : start encryption;
else (no)
   : start pairing;
endif
if (paired/re-encrypted) then (yes)
   : GATT Client request sent;
   #23DB2B : App receives GATT Response;
   stop
else (no)
   #FD5B41 : App receives a GATT Client error;
   stop
endif
@enduml

PlantUML version 1.2020.20beta13(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>