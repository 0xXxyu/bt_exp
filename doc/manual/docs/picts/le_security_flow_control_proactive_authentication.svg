<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="492px" preserveAspectRatio="none" style="width:565px;height:492px;" version="1.1" viewBox="0 0 565 492" width="565px" zoomAndPan="magnify"><defs><filter height="300%" id="fwalz9fe9wo82" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="315" x="124.25" y="26.708">Proactive Authentication with LTK</text><ellipse cx="229.75" cy="40.9531" fill="#000000" filter="url(#fwalz9fe9wo82)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="170.25" y="70.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="184.25" y="92.0918">A connects to B</text><rect fill="#FEFECE" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="102.75" y="124.9219"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="230" x="116.75" y="146.0605">App triggers GATT Client request on A</text><polygon fill="#FEFECE" filter="url(#fwalz9fe9wo82)" points="217.75,178.8906,241.75,178.8906,253.75,190.8906,241.75,202.8906,217.75,202.8906,205.75,190.8906,217.75,178.8906" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="22" x="218.75" y="194.6987">role</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="41" x="164.75" y="188.2964">Central</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="57" x="253.75" y="188.2964">Peripheral</text><rect fill="#FEFECE" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="91.25" y="212.8906"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="105.25" y="234.0293">start encryption</text><rect fill="#FEFECE" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="230.25" y="212.8906"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="133" x="244.25" y="234.0293">send security request</text><polygon fill="#FEFECE" filter="url(#fwalz9fe9wo82)" points="229.75,252.8594,241.75,264.8594,229.75,276.8594,217.75,264.8594,229.75,252.8594" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fwalz9fe9wo82)" points="192.75,296.8594,266.75,296.8594,278.75,308.8594,266.75,320.8594,192.75,320.8594,180.75,308.8594,192.75,296.8594" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="192.75" y="312.6675">re-encrypted</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="159.75" y="306.2651">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="278.75" y="306.2651">no</text><rect fill="#FEFECE" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="26.5" y="330.8594"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149" x="40.5" y="351.998">GATT Client request sent</text><rect fill="#23DB2B" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="11" y="384.8281"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180" x="25" y="405.9668">App receives GATT Response</text><ellipse cx="113" cy="464.7969" fill="#FFFFFF" filter="url(#fwalz9fe9wo82)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="113" cy="464.7969" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FD5B41" filter="url(#fwalz9fe9wo82)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="235" y="330.8594"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="199" x="249" y="351.998">App receives a GATT Client error</text><path d="M377.5,384.8281 L377.5,408.5273 L357.5,412.5273 L377.5,416.5273 L377.5,440.2266 A0,0 0 0 0 377.5,440.2266 L553.5,440.2266 A0,0 0 0 0 553.5,440.2266 L553.5,394.8281 L543.5,384.8281 L377.5,384.8281 A0,0 0 0 0 377.5,384.8281 " fill="#FBFB77" filter="url(#fwalz9fe9wo82)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M543.5,384.8281 L543.5,394.8281 L553.5,394.8281 L543.5,384.8281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="383.5" y="401.895">App can delete bonding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="383.5" y="417.0278">information and repeat</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="383.5" y="432.1606">the GATT Client request</text><ellipse cx="346.5" cy="412.5273" fill="#FFFFFF" filter="url(#fwalz9fe9wo82)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="346.5" cy="412.5273" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="50.9531" y2="70.9531"/><polygon fill="#A80036" points="225.75,60.9531,229.75,70.9531,233.75,60.9531,229.75,64.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="104.9219" y2="124.9219"/><polygon fill="#A80036" points="225.75,114.9219,229.75,124.9219,233.75,114.9219,229.75,118.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="205.75" x2="150.75" y1="190.8906" y2="190.8906"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="150.75" x2="150.75" y1="190.8906" y2="212.8906"/><polygon fill="#A80036" points="146.75,202.8906,150.75,212.8906,154.75,202.8906,150.75,206.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="253.75" x2="308.75" y1="190.8906" y2="190.8906"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="308.75" x2="308.75" y1="190.8906" y2="212.8906"/><polygon fill="#A80036" points="304.75,202.8906,308.75,212.8906,312.75,202.8906,308.75,206.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="150.75" x2="150.75" y1="246.8594" y2="264.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="150.75" x2="217.75" y1="264.8594" y2="264.8594"/><polygon fill="#A80036" points="207.75,260.8594,217.75,264.8594,207.75,268.8594,211.75,264.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="308.75" x2="308.75" y1="246.8594" y2="264.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="308.75" x2="241.75" y1="264.8594" y2="264.8594"/><polygon fill="#A80036" points="251.75,260.8594,241.75,264.8594,251.75,268.8594,247.75,264.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="158.8906" y2="178.8906"/><polygon fill="#A80036" points="225.75,168.8906,229.75,178.8906,233.75,168.8906,229.75,172.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="364.8281" y2="384.8281"/><polygon fill="#A80036" points="109,374.8281,113,384.8281,117,374.8281,113,378.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="418.7969" y2="453.7969"/><polygon fill="#A80036" points="109,443.7969,113,453.7969,117,443.7969,113,447.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="346.5" x2="346.5" y1="364.8281" y2="401.5273"/><polygon fill="#A80036" points="342.5,391.5273,346.5,401.5273,350.5,391.5273,346.5,395.5273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="180.75" x2="113" y1="308.8594" y2="308.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="308.8594" y2="330.8594"/><polygon fill="#A80036" points="109,320.8594,113,330.8594,117,320.8594,113,324.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="278.75" x2="346.5" y1="308.8594" y2="308.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="346.5" x2="346.5" y1="308.8594" y2="330.8594"/><polygon fill="#A80036" points="342.5,320.8594,346.5,330.8594,350.5,320.8594,346.5,324.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="229.75" x2="229.75" y1="276.8594" y2="296.8594"/><polygon fill="#A80036" points="225.75,286.8594,229.75,296.8594,233.75,286.8594,229.75,290.8594" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[5e7728d7acfdc65cbf711c0ade9731e4]
@startuml
title Proactive Authentication with LTK
start
: A connects to B;
: App triggers GATT Client request on A;
if (role) then (Central)
: start encryption;
else (Peripheral)
: send security request;
endif
if (re-encrypted) then (yes)
   : GATT Client request sent;
   #23DB2B : App receives GATT Response;
   stop
else (no) 
   #FD5B41 : App receives a GATT Client error;
   stop
   note right
      App can delete bonding 
      information and repeat 
      the GATT Client request
   end note
endif
@enduml

PlantUML version 1.2020.20beta13(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>