<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="506px" preserveAspectRatio="none" style="width:626px;height:506px;" version="1.1" viewBox="0 0 626 506" width="626px" zoomAndPan="magnify"><defs><filter height="300%" id="f1a1jpegzt8428" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="315" x="154.75" y="26.708">Proactive Authentication with LTK</text><ellipse cx="260.25" cy="40.9531" fill="#000000" filter="url(#f1a1jpegzt8428)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1a1jpegzt8428)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="200.75" y="70.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="214.75" y="92.0918">A connects to B</text><rect fill="#FEFECE" filter="url(#f1a1jpegzt8428)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="133.25" y="124.9219"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="230" x="147.25" y="146.0605">App triggers GATT Client request on A</text><polygon fill="#FEFECE" filter="url(#f1a1jpegzt8428)" points="248.25,178.8906,272.25,178.8906,284.25,190.8906,272.25,202.8906,248.25,202.8906,236.25,190.8906,248.25,178.8906" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="22" x="249.25" y="194.6987">role</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="41" x="195.25" y="188.2964">Central</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="57" x="284.25" y="188.2964">Peripheral</text><rect fill="#FEFECE" filter="url(#f1a1jpegzt8428)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="121.75" y="212.8906"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="135.75" y="234.0293">start encryption</text><rect fill="#FEFECE" filter="url(#f1a1jpegzt8428)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="260.75" y="212.8906"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="133" x="274.75" y="234.0293">send security request</text><polygon fill="#FEFECE" filter="url(#f1a1jpegzt8428)" points="260.25,252.8594,272.25,264.8594,260.25,276.8594,248.25,264.8594,260.25,252.8594" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f1a1jpegzt8428)" points="223.25,296.8594,297.25,296.8594,309.25,308.8594,297.25,320.8594,223.25,320.8594,211.25,308.8594,223.25,296.8594" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="223.25" y="312.6675">re-encrypted</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="190.25" y="306.2651">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="309.25" y="306.2651">no</text><rect fill="#FEFECE" filter="url(#f1a1jpegzt8428)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="26.5" y="330.8594"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149" x="40.5" y="351.998">GATT Client request sent</text><rect fill="#23DB2B" filter="url(#f1a1jpegzt8428)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="11" y="398.7969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180" x="25" y="419.9355">App receives GATT Response</text><ellipse cx="113" cy="478.7656" fill="#FFFFFF" filter="url(#f1a1jpegzt8428)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="113" cy="478.7656" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FD5B41" filter="url(#f1a1jpegzt8428)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="345" x="235" y="330.8594"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="267" x="249" y="351.998">App receives GATT_QUERY_COMPLETE event</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="297" x="273" y="365.9668">with ATT_ERROR_BONDING_INFORMATION_MISSING</text><path d="M438.5,412.7656 L438.5,436.4648 L418.5,440.4648 L438.5,444.4648 L438.5,468.1641 A0,0 0 0 0 438.5,468.1641 L614.5,468.1641 A0,0 0 0 0 614.5,468.1641 L614.5,422.7656 L604.5,412.7656 L438.5,412.7656 A0,0 0 0 0 438.5,412.7656 " fill="#FBFB77" filter="url(#f1a1jpegzt8428)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M604.5,412.7656 L604.5,422.7656 L614.5,422.7656 L604.5,412.7656 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="444.5" y="429.8325">App can delete bonding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="444.5" y="444.9653">information and repeat</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="444.5" y="460.0981">the GATT Client request</text><ellipse cx="407.5" cy="440.4648" fill="#FFFFFF" filter="url(#f1a1jpegzt8428)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="407.5" cy="440.4648" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260.25" x2="260.25" y1="50.9531" y2="70.9531"/><polygon fill="#A80036" points="256.25,60.9531,260.25,70.9531,264.25,60.9531,260.25,64.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260.25" x2="260.25" y1="104.9219" y2="124.9219"/><polygon fill="#A80036" points="256.25,114.9219,260.25,124.9219,264.25,114.9219,260.25,118.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="236.25" x2="181.25" y1="190.8906" y2="190.8906"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="181.25" x2="181.25" y1="190.8906" y2="212.8906"/><polygon fill="#A80036" points="177.25,202.8906,181.25,212.8906,185.25,202.8906,181.25,206.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="284.25" x2="339.25" y1="190.8906" y2="190.8906"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="339.25" x2="339.25" y1="190.8906" y2="212.8906"/><polygon fill="#A80036" points="335.25,202.8906,339.25,212.8906,343.25,202.8906,339.25,206.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="181.25" x2="181.25" y1="246.8594" y2="264.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="181.25" x2="248.25" y1="264.8594" y2="264.8594"/><polygon fill="#A80036" points="238.25,260.8594,248.25,264.8594,238.25,268.8594,242.25,264.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="339.25" x2="339.25" y1="246.8594" y2="264.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="339.25" x2="272.25" y1="264.8594" y2="264.8594"/><polygon fill="#A80036" points="282.25,260.8594,272.25,264.8594,282.25,268.8594,278.25,264.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260.25" x2="260.25" y1="158.8906" y2="178.8906"/><polygon fill="#A80036" points="256.25,168.8906,260.25,178.8906,264.25,168.8906,260.25,172.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="364.8281" y2="398.7969"/><polygon fill="#A80036" points="109,388.7969,113,398.7969,117,388.7969,113,392.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="432.7656" y2="467.7656"/><polygon fill="#A80036" points="109,457.7656,113,467.7656,117,457.7656,113,461.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="407.5" x2="407.5" y1="378.7969" y2="429.4648"/><polygon fill="#A80036" points="403.5,419.4648,407.5,429.4648,411.5,419.4648,407.5,423.4648" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="211.25" x2="113" y1="308.8594" y2="308.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="113" x2="113" y1="308.8594" y2="330.8594"/><polygon fill="#A80036" points="109,320.8594,113,330.8594,117,320.8594,113,324.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="309.25" x2="407.5" y1="308.8594" y2="308.8594"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="407.5" x2="407.5" y1="308.8594" y2="330.8594"/><polygon fill="#A80036" points="403.5,320.8594,407.5,330.8594,411.5,320.8594,407.5,324.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="260.25" x2="260.25" y1="276.8594" y2="296.8594"/><polygon fill="#A80036" points="256.25,286.8594,260.25,296.8594,264.25,286.8594,260.25,290.8594" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[44788bdd32f7dd64cafb8bcb39bd5e6b]
@startuml
title Proactive Authentication with LTK
start
: A connects to B;
: App triggers GATT Client request on A;
if (role) then (Central)
: start encryption;
else (Peripheral)
: send security request;
endif
if (re-encrypted) then (yes)
   : GATT Client request sent;
   #23DB2B : App receives GATT Response;
   stop
else (no) 
   #FD5B41: App receives GATT_QUERY_COMPLETE event 
          with ATT_ERROR_BONDING_INFORMATION_MISSING;
   stop
   note right
      App can delete bonding 
      information and repeat 
      the GATT Client request
   end note
endif
@enduml

PlantUML version 1.2020.20(Sat Nov 21 10:02:45 UTC 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>